on_game_start = {
	on_actions = {
		mb_on_game_start
	}
}

mb_on_game_start = {
	effect = {
		
		if = {
			limit = {
				has_fp2_dlc_trigger = yes
			}
			start_struggle = { struggle_type = iberian_struggle start_phase = struggle_iberia_phase_opportunity }
		}
		if = {
			limit = {
				game_start_date >= 1098.1.1
				game_start_date < 1234.1.1
				has_fp2_dlc_trigger = yes
			}
			struggle:iberian_struggle = {
				change_struggle_phase = struggle_iberia_phase_hostility # Change to hostility. The Almoravids were not as tolerant of Christians and did invade the Peninsula several times. They collapsed in the late 1140's and were replaced with the Almohads who actually reversed part of the reconquista for a short time. They suffered a decisive defeat in 1212 which marked the end of any further Islamic conquests in Iberia
				set_faith_as_involved = faith:masmudi
			}
		}
		if = {
			limit = {
				game_start_date >= 1235.1.1
				game_start_date < 1266.1.1
				has_fp2_dlc_trigger = yes
			}
			struggle:iberian_struggle = {
				change_struggle_phase = struggle_iberia_phase_compromise # Change to compromise phase. Almohads no longer control any of al-Andalus
				set_culture_as_involved = culture:french
			}
		}
		
		if = {
			limit = {
				game_start_date >= 1267.1.1
				has_fp2_dlc_trigger = yes
			}
			struggle:iberian_struggle = {
				change_struggle_phase = struggle_iberia_phase_conciliation # Change to final phase which is conciliation. Marked by the only remaining Emirate, the Emirate of Granada, being a tributary of Castile. This would be how things would continue till it was finally conquered in 1492
			}
		}
		
		if = {
			limit = {
				exists = title:e_byzantium.holder
				game_start_date >= 1081.4.1
			}
			title:e_byzantium.holder = {
				every_vassal = {
					limit = {
						vassal_contract_has_modifiable_obligations = yes
					}
					#vassal_contract_decrease_obligation_level = feudal_government_taxes
					vassal_contract_decrease_obligation_level = feudal_government_levies
					set_vassal_contract_modification_blocked = no
				}
			}
		}
		
		every_living_character = {
			limit = {
				OR = {
					has_culture = culture:serbian
					has_culture = culture:croatian
				}
				is_landed = yes
				is_ruler = yes
				has_government = feudal_government
				has_faith = faith:slavic_pagan
			}
			change_government = tribal_government
		}
		
		
		
		culture:old_saxon = {
			set_heritage_from = culture:saxon
			set_language_from = culture:saxon
		}
		culture:ilmenian = {
			set_name_list = name_list_old_east_slavic
		}
		culture:severian = {
			set_name_list = name_list_old_east_slavic
		}
		culture:volhynian = {
			set_name_list = name_list_old_east_slavic
		}
		culture:mon = {
			set_culture_pillar = language_mon
		}
		culture:khitan = {
			set_culture_pillar = language_xianbei
		}
		culture:tuyuhun = {
			set_culture_pillar = language_xianbei
		}
		
		
		every_living_character = {
			limit = {
				age > 150
			}
			death = {
				death_reason = death_natural_causes
			}
		}
		
		if = {
			limit = { exists = title:d_muwalladi.holder }
			faith:muwalladi = {
				set_religious_head_title = title:d_muwalladi
			}
		}
		title:d_muwalladi = {
			add_title_law = temporal_head_of_faith_succession_law
		}
		faith:zayidi = {
			set_religious_head_title = title:d_zayidi
		}
		if = {
			limit = {
				exists = title:d_zayidi.holder
				d_zayidi.holder = { highest_held_title_tier = tier_duchy }
			}
			title:d_zayidi.holder = {
				set_primary_title_to = title:d_zayidi
			}
		}
		title:d_zayidi = {
			add_title_law = temporal_head_of_faith_succession_law
		}
		faith:alevi = {
			set_religious_head_title = title:d_imami
		}
		if = {
			limit = { game_start_date < 1000.1.1 }
			title:k_italy = { set_capital_county = title:c_pavia }
			title:k_italy.holder = { set_realm_capital = title:c_pavia }
		}
		if = {
			limit = { game_start_date > 1067.1.1 }
			title:k_sakya_trizin.holder = { add_realm_law_skip_effects = male_preference_law }
		}


		if = {
			limit = {
				game_start_date > 1095.11.27
			}
			religion:christianity_religion = {
				every_faith = {
					religion = {
						set_variable = {
							name = variable_ghw_unlocked # Crusades
							value = yes
						}
					}
				}
			}
			religion:islam_religion = {
				every_faith = {
					religion = {
						set_variable = {
							name = variable_ghw_unlocked # Crusades
							value = yes
						}
					}
				}
			}
		}
		
	
	
	####1187 ###
	
		if = {
			limit = {
				game_start_date = 1187.1.1
			}
			character:230000 = { set_realm_capital = title:c_gurganj }
			character:204500 = {
				if = {
					limit = {
						is_alive = yes
						is_landed = yes
					}
				}
				house = {
					add_house_modifier = {
						modifier = ireland_laudabiliter_modifier
						days = 25101
					}
				}
			}
			faith:catholic = {
				change_fervor = {
					value = 24
					desc = cultural_acceptance_historical_relations#test_interaction_fervor_gain
				}
			}
			faith:ashari = {
				change_fervor = {
					value = 25
					desc = cultural_acceptance_historical_relations#test_interaction_fervor_gain
				}
			}
			faith:masmudi = {
				change_fervor = {
					value = 25
					desc = cultural_acceptance_historical_relations#test_interaction_fervor_gain
				}
			}
			faith:slavic_pagan = {
				change_fervor = {
					value = -30
					desc = cultural_acceptance_historical_relations#test_interaction_fervor_gain
				}
			}
		}
		character:226000 = { #Saladin
			if = {
				limit = {
					is_alive = yes
					is_landed = yes
				}
				trigger_event = {
					id = asdac_bookmark.1101
					days = 71
				}
			}
		}
	
		
		
		### 1204 ###
		
		if = {
			limit = {
				game_start_date = 1204.5.16
			}
			character:93052 = { set_realm_capital = title:c_gurganj }
			faith:orthodox = {
				change_fervor = {
					value = 25
					desc = cultural_acceptance_historical_relations#test_interaction_fervor_gain
				}
			}
			faith:ashari = {
				change_fervor = {
					value = 25
					desc = cultural_acceptance_historical_relations#test_interaction_fervor_gain
				}
			}
			faith:masmudi = {
				change_fervor = {
					value = 25
					desc = cultural_acceptance_historical_relations#test_interaction_fervor_gain
				}
			}
			faith:slavic_pagan = {
				change_fervor = {
					value = -30
					desc = cultural_acceptance_historical_relations#test_interaction_fervor_gain
				}
			}
			character:204514 = {
				if = {
					limit = {
						is_alive = yes
						is_landed = yes
					}
				}
				house = {
					add_house_modifier = {
						modifier = ireland_laudabiliter_modifier
						days = 18761
					}
				}
			}
			character:125501 = { #Genghis Khan Temujin
				if = {
					limit = {
						is_alive = yes
						is_landed = yes
					}
					trigger_event = {
						id = asdac_bookmark.2001
						days = 1
					}
					trigger_event = {
						id = asdac_bookmark.2002
						days = 1
					}
				}
			}
		}
		
		
		#1235
		
		if = {
			limit = {
				game_start_date > 1235.1.1
			}
			faith:bosnian_church = { remove_doctrine = special_doctrine_ecumenical_christian }
		}
		
		
		#1258
		
		if = {
			limit = {
				game_start_date > 1258.1.1
			}
			province:4828 = {
				remove_building = house_of_wisdom_01
			}
		}
		
		
		#1337
		
		if = {
			limit = {
				game_start_date = 1337.1.1
			}
			title:d_ryazan.holder = { set_realm_capital = title:c_ryazan }
			title:e_golden_horde.holder = { set_realm_capital = title:c_itil }
			faith:slavic_pagan = {
				change_fervor = {
					value = -30
					desc = cultural_acceptance_historical_relations#test_interaction_fervor_gain
				}
			}
			character:170258 = {
				set_realm_capital = title:c_delhi
			}
			title:d_opsikion = { set_capital_county = title:c_prusa } #Nicaea was irrelevant during the Ottoman period
			title:k_nikaea = { set_capital_county = title:c_prusa }
			title:d_opsikion.holder = { set_realm_capital = title:c_prusa }
			title:c_nikaea = { set_color_from_title = title:c_nikaea }
			
			title:d_anatolia.holder = { set_realm_capital = title:c_lycaonia }
						
			title:d_charsianon.holder = { set_realm_capital = title:c_kaisereia }
			
			title:d_paphlagonia.holder = { set_realm_capital = title:c_pompeiopolis }
			
			title:d_thracesia.holder = { set_realm_capital = title:c_chonae }
		}
		
		if = {
			limit = { game_start_date = 1337.1.1 }
			culture:irish = { remove_culture_tradition = tradition_polygamous }
			culture:gaelic = { remove_culture_tradition = tradition_concubines }
			culture:welsh = { remove_culture_tradition = tradition_concubines }
			culture:cumbrian = { remove_culture_tradition = tradition_concubines }
		}
		if = {
			limit = { game_start_date > 1080.1.1 }
			culture:greek = { add_culture_tradition = tradition_zealous_people }
		}
		
		
		#############
		
		##A much easier way to set de_jure territory changes without touching history files. Also comes with the added benefit of it not requiring me to restart the game to test it
		
		
		#Titles that never have a de_jure
		
		if = {
			limit = {
				game_start_date >= 769.1.1
			}

			title:k_papal_state = { set_de_jure_liege_title = title:e_null_empire } #Papacy should never be 'de jure' anything. Trying to lay claim to the Papacy typically lead to a war with your neighbors. For example Lombardia claiming Rome was used as a reason by Charlemagne to invade.
			title:k_venice = { set_de_jure_liege_title = title:e_null_empire } #The Republics should stay independent. An empire could vassalize them but they weren't going to be happy about it.
			title:k_genoa = { set_de_jure_liege_title = title:e_null_empire } #The Republics should stay independent. An empire could vassalize them but they weren't going to be happy about it.
			title:k_pisa = { set_de_jure_liege_title = title:e_null_empire } #The Republics should stay independent. An empire could vassalize them but they weren't going to be happy about it.
			
			title:k_georgia = { set_de_jure_liege_title = title:e_null_empire } #We don't want the ERE 'de jure' conquering Armenia or Georgia
			title:k_old_armenia = { set_de_jure_liege_title = title:e_null_empire } #We don't want the ERE 'de jure' conquering Armenia or Georgia
			title:k_caucasus = { set_de_jure_liege_title = title:e_null_empire } #Don't want the ERE having a de jure Alania or a steppe tribe having a de jure claim on it
			title:k_armenia = { set_de_jure_liege_title = title:e_null_empire } #We don't want the ERE 'de jure' conquering Armenia or Georgia
			title:k_kabulistan = { set_de_jure_liege_title = title:e_null_empire } #The region of Afghanistan tended to change hands quite often and was more a borderland
			title:k_shirvan = { set_de_jure_liege_title = title:e_null_empire } #Don't want Persia having a claim on Shirvan 
			
			title:k_sahara = { set_de_jure_liege_title = title:e_null_empire } #It's the Sahara. Even in the EU4 time period you'd have a hard time convincing me to allow an empire having 'de jure' control of this
			
		}
		
		if = {
			limit = {
				game_start_date >= 1234.1.1
			}
		
			title:k_khwarezmia = { set_de_jure_liege_title = title:e_null_empire } #Region became a borderland between the 3 Khaganates

			
		}
		
		
		#For when Old Armenia is used in 769
		if = {
			limit = {
				game_start_date >= 769.1.1
				game_start_date <= 861.1.1
			}

			title:d_greater_armenia = { set_de_jure_liege_title = title:k_old_armenia }
			title:d_suenik = { set_de_jure_liege_title = title:k_old_armenia }
			title:d_vaspurakan = { set_de_jure_liege_title = title:k_old_armenia }
			title:d_mesopotamia = { set_de_jure_liege_title = title:k_old_armenia }
			title:d_dzopk = { set_de_jure_liege_title = title:k_old_armenia }
			title:d_artsakh = { set_de_jure_liege_title = title:k_old_armenia }
			title:d_georgia = { set_de_jure_liege_title = title:k_old_armenia }
			title:d_taron = { set_de_jure_liege_title = title:k_old_armenia }
			title:d_melitene = { set_de_jure_liege_title = title:k_old_armenia }
		}
		
		#HRE setup
		
		if = {
			limit = {
				game_start_date >= 993.1.1
				game_start_date < 1000.1.1
			}

			title:k_italy = { set_de_jure_liege_title = title:e_hre }
			title:k_romagna = { set_de_jure_liege_title = title:e_hre }
			title:k_burgundy = { set_de_jure_liege_title = title:e_hre }
			title:k_sardinia = { set_de_jure_liege_title = title:e_null_empire } #To remove the e_italia title since when the HRE has Italy the only remaining title is Sardinia. 
		}
		
		if = {
			limit = {
				game_start_date >= 1001.1.1
				game_start_date <= 1266.1.1
			}

			title:k_italy = { set_de_jure_liege_title = title:e_hre }
			title:k_romagna = { set_de_jure_liege_title = title:e_hre }
			title:k_burgundy = { set_de_jure_liege_title = title:e_hre }
			title:k_sardinia = { set_de_jure_liege_title = title:e_null_empire } #To remove the e_italia title since when the HRE has Italy the only remaining title is Sardinia. 
			title:k_sicily = { set_de_jure_liege_title = title:e_null_empire } #ERE loses claim on Sicily but it'd be odd to have a 'Empire of Italy' that consists just of Sardinia and Sicily and I don't want the HRE having an easy way to get Sicily
		}
		
		if = {
			limit = {
				game_start_date >= 1267.1.1 #Once the Hohenstaufens are gone all that remains is northern Italy under the HRE. Can let e_italy exist again.
				game_start_date <= 1338.1.1
			}
			title:k_burgundy = { set_de_jure_liege_title = title:e_hre } 
		}
		
		#End HRE setup
		
		
		#ERE Setup - To show the weakening of the ERE
		
		if = {
			limit = {
				game_start_date >= 1081.1.1
				game_start_date <= 1300.1.1
			}
		
			title:k_anatolia = { set_de_jure_liege_title = title:e_null_empire } #Anatolia lost to the Turks
		}
		
		if = {
			limit = {
				game_start_date >= 1166.1.1
			}
		
			title:k_cilician = { set_de_jure_liege_title = title:e_null_empire } #Cilicia never back under the ERE
		}
		
		if = {
			limit = {
				game_start_date >= 1194.1.1
			}
		
			title:k_cyprus = { set_de_jure_liege_title = title:e_null_empire } #Cyprus lost to the crusader states
			
		}
		
		if = {
			limit = {
				game_start_date >= 1337.1.1
			}
		
			title:k_serbia = { set_de_jure_liege_title = title:e_serbia }
		}
		
		if = {
			limit = {
				game_start_date = 1018.8.1
			}
		
			title:k_bulgaria = { set_de_jure_liege_title = title:e_byzantium }
		}
		
		#End ERE setup
		
		#For when the Liao Dynasty controls Mongolia
		if = {
			limit = {
				game_start_date >= 1018.1.1
				game_start_date <= 1127.1.1
			}

			title:d_arkhangai = { set_de_jure_liege_title = title:k_liao }
			title:d_gobi_altai = { set_de_jure_liege_title = title:k_liao }
			title:d_khovd = { set_de_jure_liege_title = title:k_liao }
			title:d_khovsgol = { set_de_jure_liege_title = title:k_liao }
			title:d_selenga_valley = { set_de_jure_liege_title = title:k_liao }
			title:d_ubsunur_hollow = { set_de_jure_liege_title = title:k_liao }
			title:d_ogrash = { set_de_jure_liege_title = title:k_liao }
			title:d_otuken = { set_de_jure_liege_title = title:k_liao }
			title:d_ovorkhangai = { set_de_jure_liege_title = title:k_liao }
		}
		
		#For when the Kara-Khitai exist
		if = {
			limit = {
				game_start_date >= 1144.1.1
				game_start_date <= 1219.1.1
			}
		
			title:k_zhetysu = { set_de_jure_liege_title = title:e_kara_khitai } 
			title:k_syr_darya = { set_de_jure_liege_title = title:e_kara_khitai } 
			title:k_transoxiana = { set_de_jure_liege_title = title:e_kara_khitai } 
		}
		
	
		
		
		##############
		
		character:455810 = {
			if = {
				limit = {
					is_alive = yes
					is_landed = yes
				}
				unlearn_language = language_iberian
			}
		}
		if = {
			limit = {
				game_start_date = 1337.1.1
			}
			character:455810 = {
				unlearn_language = language_iberian
			}
		}
		if = {
			limit = {
				exists = struggle:iberian_struggle
			}
			struggle:iberian_struggle = { set_culture_as_involved = culture:aragonese }
		}
		culture:turkish = {
			change_cultural_acceptance = {
				target = culture:greek
				value = -95
				desc = cultural_acceptance_historical_relations
			}
		}
		culture:tajik = {
			change_cultural_acceptance = {
				target = culture:persian
				value = 70
				desc = cultural_acceptance_historical_relations
			}
		}
		culture:baloch = {
			change_cultural_acceptance = {
				target = culture:sindhi
				value = 10
				desc = cultural_acceptance_historical_relations
			}
		}
		culture:arberian = {
			change_cultural_acceptance = {
				target = culture:serbian
				value = 15
				desc = cultural_acceptance_historical_relations
			}
		}
		culture:crimean_gothic = {
			change_cultural_acceptance = {
				target = culture:greek
				value = 15
				desc = cultural_acceptance_historical_relations
			}
		}
		if = {
			limit = {
				game_start_date = 1337.1.1
			}
			culture:dalmatian = {
				change_cultural_acceptance = {
					target = culture:croatian
					value = 20
					desc = cultural_acceptance_historical_relations
				}
			}
			culture:arberian = {
				change_cultural_acceptance = {
					target = culture:sicilian
					value = 15
					desc = cultural_acceptance_historical_relations
				}
			}
		}
		if = {
			limit = {
				exists = title:k_italy.holder
				has_dlc_feature = royal_court
			}
			title:k_italy.holder = {
				create_artifact_pedestal_crown_iron_effect = { OWNER = title:k_italy.holder }
			}
		}
		if = {
			limit = { game_start_date = 1337.1.1 }
			if = {
				limit = {
					OR = {
						has_game_rule = matrilineal_marriages_never
						AND = {
							has_game_rule = matrilineal_marriages_female_and_equal
							has_game_rule = default_gender_equality
						}
					}
				}
				character:461703 = {
					create_betrothal = character:469513
				}
			} 
			else = {
				character:461703 = {
					create_betrothal_matrilineal = character:469513
				}
			}
		}
		every_living_character = {
			limit = {
				culture = culture:mon
			}
			unlearn_language = language_burmese
			learn_language = language_mon
		}
		every_living_character = {
			limit = {
				OR = {
					culture = culture:khitan
					culture = culture:tuyuhun
				}
			}
			unlearn_language = language_mongolic
			learn_language = language_xianbei
		}
		every_living_character = {
			limit = {
				culture = culture:old_saxon
			}
			unlearn_language = language_anglic
			learn_language = language_saxon
		}
		every_living_character = {
			limit = {
				culture = culture:ongud
			}
			unlearn_language = language_turkic
			learn_language = language_mongolic
		}
		every_living_character = {
			limit = {
				OR = {
					dynasty = dynasty:7276
					dynasty = dynasty:7277
					dynasty = dynasty:101732
					dynasty = dynasty:101875
				}
			}
			learn_language = language_arabic
		}
		every_living_character = {
			limit = {
				dynasty = dynasty:1000102400
				NOT = { house = house:house_quglugh }
			}
			learn_language = language_chinese
		}
		culture:egyptian_coptic = {
			change_cultural_acceptance = {
				target = culture:egyptian
				value = 20
				desc = cultural_acceptance_historical_relations
			}
		}
		
		
	}
}


